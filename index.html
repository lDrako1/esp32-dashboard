<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Dashboard Riego ESP32</title>
<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
<style>
body {
    font-family: Arial; 
    background: #111;
    color: #eee;
    text-align: center;
}
.box {
    margin: 20px auto;
    padding: 20px;
    width: 300px;
    background: #222;
    border-radius: 10px;
}
.value {
    font-size: 40px;
    margin-top: 10px;
}
</style>
</head>

<body>

<h2>ðŸŒ± Dashboard del ESP32</h2>

<div class="box">
    <h3>Temperatura</h3>
    <div id="temp" class="value">-- Â°C</div>
</div>

<div class="box">
    <h3>Humedad Ambiente</h3>
    <div id="hum" class="value">-- %</div>
</div>

<div class="box">
    <h3>Estado del Riego</h3>
    <div id="status" class="value">---</div>
</div>

<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>

<script>
// Conectar a WebSockets MQTT
const client = mqtt.connect("wss://broker.emqx.io:8084/mqtt");

client.on("connect", function () {
    console.log("Conectado a MQTT");

    client.subscribe("esp32/temperatura");
    client.subscribe("esp32/humedad");
    client.subscribe("esp32/riego/status");
});

client.on("message", function (topic, message) {
    let data = message.toString();

    if (topic === "esp32/temperatura") {
        document.getElementById("temp").innerText = data + " Â°C";
    }
    if (topic === "esp32/humedad") {
        document.getElementById("hum").innerText = data + " %";
    }
    if (topic === "esp32/riego/status") {
        document.getElementById("status").innerText = data;
    }
});
</script>

</body>
</html>

